"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),DynamicForms=function(){function e(){_classCallCheck(this,e),this.dynamic_elements={},this.elements={},this.templates={}}return _createClass(e,[{key:"automaticallySetupForm",value:function(){$("[data-dynamic-form] [data-dynamic-form-template]").each(function(e,t){var a=$(t),n=a.parent();this.setupForm(n,a)}.bind(this))}},{key:"setupForm",value:function(t,a){a.detach();var n=a.data("dynamic-form-fill");if(void 0===n)this.createNewRow(t,a);else if("string"!=typeof n){for(var i in n)n.hasOwnProperty(i)&&this.createNewRow(t,a,i,n[i]);this.createNewRow(t,a)}else this.createNewRow(t,a);e.disableBottomRemoveButton(t)}},{key:"createNewRow",value:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=a.clone(),r=a.data("dynamic-form-template");void 0===this.templates[r]?this.templates[r]=0:this.templates[r]++;var m=this.templates[r];o.removeAttr("data-dynamic-form-template"),o.removeAttr("data-dynamic-form-fill");var d=void 0;o.find("[data-dynamic-form-input-id-template]").each(function(t,a){var o=$(a),r=o.attr("name");d=void 0===this.dynamic_elements[r];var m=o.data("dynamic-form-input-id-template");if(void 0!==i){var c=o.data("dynamic-form-input-name");"string"==typeof i?o.val(i):"object"===(void 0===i?"undefined":_typeof(i))&&i.hasOwnProperty(c)&&o.val(i[c])}var s=void 0;void 0===n?(void 0===this.dynamic_elements[r]?this.dynamic_elements[r]=0:this.dynamic_elements[r]++,s=r.replace(m,e.numToChar(this.dynamic_elements[r]))):void 0!==n&&(void 0===this.elements[r]?this.elements[r]=0:this.elements[r]++,s=r.replace(m,this.elements[r])),o.attr("name",s)}.bind(this)),o.find("[data-dynamic-form-add]").each(function(n,i){var o=$(i);o.attr("data-dynamic-form-add",e.getDataTagForButton(r,"add",m)),o.click(function(){this.createNewRow(t,a),e.disableBottomRemoveButton(t)}.bind(this))}.bind(this)),o.find("[data-dynamic-form-remove]").each(function(a,i){var d=$(i);d.attr("data-dynamic-form-remove",e.getDataTagForButton(r,"remove",m)),d.click(function(){o.remove(),e.disableBottomRemoveButton(t),e.updateRemoveField(t,r,n)}.bind(this))}.bind(this)),o.show(),o.appendTo(t)}}],[{key:"updateRemoveField",value:function(e,t,a){if(!isNaN(parseInt(a))&&isFinite(a))if(0===e.find("input[type='hidden']").length)e.prepend('<input type="hidden" name="remove_'+t+'" value="'+a+'" />');else{var n=$(e.find("input[type='hidden']")[0]),i=n.val();n.val(i+","+a)}}},{key:"getDataTagForButton",value:function(e,t,a){return e+"-"+t+"-"+a}},{key:"disableBottomRemoveButton",value:function(e){e.find("[data-dynamic-form-remove]").each(function(e,t){$(t).show()}),e.find("[data-dynamic-form-remove]").last().hide()}},{key:"numToChar",value:function(e){var t="abcdefghijklmnopqrstuvwxyz",a="";for(e++;e>0;){e--;var n=e%t.length;a=t[n]+a,e=(e-n)/t.length}return a}}]),e}();window.DynamicForms=DynamicForms;